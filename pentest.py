# import sys
# from PyQt4 import QtCore, QtGui, uic
 
# qtCreatorFile = "main.ui"
 
# Ui_MainWindow, QtBaseClass = uic.loadUiType(qtCreatorFile)
 
# class PenTest(QtGui.QMainWindow, Ui_MainWindow):
# 	def __init__(self):
# 		QtGui.QMainWindow.__init__(self)
# 		Ui_MainWindow.__init__(self)
# 		self.setupUi(self)

# 		self.actionExit.setStatusTip('Exit application')
# 		self.actionExit.triggered.connect(self.close)

		


 
# if __name__ == "__main__":
# 	app = QtGui.QApplication(sys.argv)
# 	window = PenTest()
# 	window.show()
# 	sys.exit(app.exec_()) 

import sys
from PyQt4 import QtCore, QtGui, uic
import PySide
from sc import main1
# import sc
 
# qtCreatorFile = "main.ui"
# qtConsoleCreatorFile = "console.ui"
 
# Ui_MainWindow, QtBaseClass = uic.loadUiType(qtCreatorFile)
# ConsoleWindow - uic.loadUiType(qtConsoleCreatorFile)
# class PenTestMain(QtGui.QMainWindow, Ui_MainWindow, ConsoleWindow):
# 	def __init__(self):
# 		QtGui.QMainWindow.__init__(self)
# 		Ui_MainWindow.__init__(self)
# 		ConsoleWindow.__init__(self)
# 		self.setupUi(self)

# 		# Menubar actions
# 		# Exit button
# 		self.actionExit.setStatusTip('Exit application')
# 		self.actionExit.triggered.connect(self.close)
# 		# Scan button
# 		self.actionStart_Scanning.triggered.connect(self.start_scan)





# 	def start_scan(self):
# 		Con

		


 
# if __name__ == "__main__":
# 	app = QtGui.QApplication(sys.argv)
# 	window = PenTestMain()
# 	window.show()
# 	sys.exit(app.exec_()) 


class Ui_MainWindow(object):
	def setupUi(self, MainWindow):
		MainWindow.setObjectName("MainWindow")
		MainWindow.resize(800, 600)
		self.centralwidget = QtGui.QWidget(MainWindow)
		self.centralwidget.setObjectName("centralwidget")
		MainWindow.setCentralWidget(self.centralwidget)
		self.menubar = QtGui.QMenuBar(MainWindow)
		self.menubar.setGeometry(QtCore.QRect(0, 0, 800, 30))
		self.menubar.setObjectName("menubar")
		self.menuFIle = QtGui.QMenu(self.menubar)
		self.menuFIle.setObjectName("menuFIle")
		self.menuAttacks = QtGui.QMenu(self.menubar)
		self.menuAttacks.setObjectName("menuAttacks")
		self.menuScan = QtGui.QMenu(self.menubar)
		self.menuScan.setObjectName("menuScan")
		self.menuContact = QtGui.QMenu(self.menubar)
		self.menuContact.setObjectName("menuContact")
		MainWindow.setMenuBar(self.menubar)
		self.statusbar = QtGui.QStatusBar(MainWindow)
		self.statusbar.setObjectName("statusbar")
		MainWindow.setStatusBar(self.statusbar)
		self.actionExit = QtGui.QAction(MainWindow)
		self.actionExit.setObjectName("actionExit")
		self.actionARP_Spoof = QtGui.QAction(MainWindow)
		self.actionARP_Spoof.setObjectName("actionARP_Spoof")
		self.actionDNS = QtGui.QAction(MainWindow)
		self.actionDNS.setObjectName("actionDNS")
		self.actionMail_Spoofing = QtGui.QAction(MainWindow)
		self.actionMail_Spoofing.setObjectName("actionMail_Spoofing")
		self.actionDOS = QtGui.QAction(MainWindow)
		self.actionDOS.setObjectName("actionDOS")
		self.actionARP = QtGui.QAction(MainWindow)
		self.actionARP.setObjectName("actionARP")
		self.actionDNS_2 = QtGui.QAction(MainWindow)
		self.actionDNS_2.setObjectName("actionDNS_2")
		self.actionMail_Spoofing_2 = QtGui.QAction(MainWindow)
		self.actionMail_Spoofing_2.setObjectName("actionMail_Spoofing_2")
		self.actionDOS_2 = QtGui.QAction(MainWindow)
		self.actionDOS_2.setObjectName("actionDOS_2")
		self.actionScan = QtGui.QAction(MainWindow)
		self.actionScan.setObjectName("actionScan")
		self.actionGUI = QtGui.QAction(MainWindow)
		self.actionGUI.setObjectName("actionGUI")
		self.actionStart_Scanning = QtGui.QAction(MainWindow)
		self.actionStart_Scanning.setObjectName("actionStart_Scanning")
		self.menuFIle.addAction(self.actionExit)
		self.menuAttacks.addAction(self.actionARP_Spoof)
		self.menuAttacks.addAction(self.actionDNS)
		self.menuAttacks.addAction(self.actionMail_Spoofing)
		self.menuAttacks.addAction(self.actionDOS)
		self.menuScan.addAction(self.actionStart_Scanning)
		self.menuContact.addAction(self.actionARP)
		self.menuContact.addAction(self.actionDNS_2)
		self.menuContact.addAction(self.actionMail_Spoofing_2)
		self.menuContact.addAction(self.actionDOS_2)
		self.menuContact.addAction(self.actionScan)
		self.menuContact.addAction(self.actionGUI)
		self.menubar.addAction(self.menuFIle.menuAction())
		self.menubar.addAction(self.menuAttacks.menuAction())
		self.menubar.addAction(self.menuScan.menuAction())
		self.menubar.addAction(self.menuContact.menuAction())

		

		self.retranslateUi(MainWindow)
		QtCore.QMetaObject.connectSlotsByName(MainWindow)
	


	def retranslateUi(self, MainWindow):
		MainWindow.setWindowTitle(QtGui.QApplication.translate("MainWindow", "MainWindow", None, QtGui.QApplication.UnicodeUTF8))
		self.menuFIle.setTitle(QtGui.QApplication.translate("MainWindow", "File", None, QtGui.QApplication.UnicodeUTF8))
		self.menuAttacks.setTitle(QtGui.QApplication.translate("MainWindow", "Attacks", None, QtGui.QApplication.UnicodeUTF8))
		self.menuScan.setTitle(QtGui.QApplication.translate("MainWindow", "Scan", None, QtGui.QApplication.UnicodeUTF8))
		self.menuContact.setTitle(QtGui.QApplication.translate("MainWindow", "Contact Us", None, QtGui.QApplication.UnicodeUTF8))
		self.actionExit.setText(QtGui.QApplication.translate("MainWindow", "Exit", None, QtGui.QApplication.UnicodeUTF8))
		self.actionARP_Spoof.setText(QtGui.QApplication.translate("MainWindow", "ARP Spoof", None, QtGui.QApplication.UnicodeUTF8))
		self.actionDNS.setText(QtGui.QApplication.translate("MainWindow", "DNS", None, QtGui.QApplication.UnicodeUTF8))
		self.actionMail_Spoofing.setText(QtGui.QApplication.translate("MainWindow", "Mail Spoofing", None, QtGui.QApplication.UnicodeUTF8))
		self.actionDOS.setText(QtGui.QApplication.translate("MainWindow", "DOS", None, QtGui.QApplication.UnicodeUTF8))
		self.actionARP.setText(QtGui.QApplication.translate("MainWindow", "ARP", None, QtGui.QApplication.UnicodeUTF8))
		self.actionDNS_2.setText(QtGui.QApplication.translate("MainWindow", "DNS", None, QtGui.QApplication.UnicodeUTF8))
		self.actionMail_Spoofing_2.setText(QtGui.QApplication.translate("MainWindow", "Mail Spoofing", None, QtGui.QApplication.UnicodeUTF8))
		self.actionDOS_2.setText(QtGui.QApplication.translate("MainWindow", "DOS", None, QtGui.QApplication.UnicodeUTF8))
		self.actionScan.setText(QtGui.QApplication.translate("MainWindow", "Scan", None, QtGui.QApplication.UnicodeUTF8))
		self.actionGUI.setText(QtGui.QApplication.translate("MainWindow", "GUI", None, QtGui.QApplication.UnicodeUTF8))
		self.actionStart_Scanning.setText(QtGui.QApplication.translate("MainWindow", "Start Scanning", None, QtGui.QApplication.UnicodeUTF8))

class ControlMainWindow(QtGui.QMainWindow):

	#The MainWindow, it sets up the Ui from the Ui_MainWindow class in this case

	def __init__(self, parent=None):

		super(ControlMainWindow, self).__init__(parent)

		self.ui = Ui_MainWindow()
		self.ui.setupUi(self)
		stackedWidget = QtGui.QStackedWidget()
		# self.setCentralWidget(QtGui.QStackedWidget())
		console_widget = ConsoleWidget(self)
		arp_frame_widget = ARPFrameWidget(self)
		scan_widget = ScanWidget(self)
		welcome_widget = WelcomeWidget(self)
		# self.centralWidget().addWidget(console_widget)
		stackedWidget.insertWidget(0, welcome_widget)
		stackedWidget.insertWidget(1, console_widget)
		stackedWidget.insertWidget(2, arp_frame_widget)
		stackedWidget.insertWidget(3, scan_widget)
		# stackedWidget.setCurrentIndex(0)
		# self.centralWidget().insertWidget(0, console_widget)
		# self.centralWidget().insertWidget(1, arp_frame_widget)		
		# self.centralWidget().setCurrentIndex(0)
		self.setCentralWidget(stackedWidget)
		self.ui.actionStart_Scanning.triggered.connect(self.show_scan)
		self.ui.actionARP_Spoof.triggered.connect(self.show_arp)
		self.ui.actionExit.triggered.connect(self.close)
		self.console=None
		

	def show_console(self):
		# print "getting triggered"
		# console_widget = ConsoleWidget(self)
		# self.centralWidget().addWidget(console_widget)
		# self.centralWidget().setCurrentWidget(console_widget)
		self.centralWidget().setCurrentIndex(1)

	def show_arp(self):
		# arp_frame_widget = ARPFrameWidget(self)
		# self.centralWidget().addWidget(arp_frame_widget)
		# self.centralWidget().setCurrentWidget(arp_frame_widget)
		self.centralWidget().setCurrentIndex(2)		

	def show_scan(self):
		# arp_frame_widget = ARPFrameWidget(self)
		# self.centralWidget().addWidget(arp_frame_widget)
		# self.centralWidget().setCurrentWidget(arp_frame_widget)
		self.centralWidget().setCurrentIndex(3)	
	# def console_widget():
	# #Creates the second widget and returns it to main
	# 	widget_console = QtGui.QWidget()
	# 	widget_console.ui = Ui_Console()
	# 	widget_console.ui.setupUi(widget_console)
	# 	return widget_console

	# def arp_frame_widget():

	# 	widget_arp_frame = QtGui.QWidget()
	# 	widget_arp_frame.ui = Ui_ARPFrame()
	# 	widget_arp_frame.ui.setupUi(widget_arp_frame)
	# 	return widget_arp_frame

class ConsoleWidget(QtGui.QWidget):
	def __init__(self, parent=None):
		super(ConsoleWidget, self).__init__(parent)
		self.ui = Ui_Console()
		self.ui.setupUi(self)
		self.ui.pushButton.clicked.connect(self.clear_console)
		sys.stdout = EmittingStream(textWritten=self.normalOutputWritten)
		
	def clear_console(self):
		self.ui.textEdit.setPlainText("")


	def __del__(self):
	# Restore sys.stdout
		sys.stdout = sys.__stdout__

	def normalOutputWritten(self, text):
		"""Append text to the QTextEdit."""
		# Maybe QTextEdit.append() works as well, but this is how I do it:
		cursor = self.ui.textEdit.textCursor()
		cursor.movePosition(QtGui.QTextCursor.End)
		cursor.insertText(text)
		self.ui.textEdit.setTextCursor(cursor)
		self.ui.textEdit.ensureCursorVisible()


		# self.ui.pushButton.setEnabled(True)

class ARPFrameWidget(QtGui.QWidget):
	def __init__(self, parent=None):
		super(ARPFrameWidget, self).__init__(parent)
		self.ui = Ui_ARPFrame()
		self.ui.setupUi(self)

class WelcomeWidget(QtGui.QWidget):
	def __init__(self, parent=None):
		super(WelcomeWidget, self).__init__(parent)
		self.ui = Ui_Welcome()
		self.ui.setupUi(self)

class ScanWidget(QtGui.QWidget):

	def __init__(self, parent=None):
		super(ScanWidget, self).__init__(parent)
		self.ui = Ui_ScanWidget()
		self.ui.setupUi(self)
		self.ui.pushButton.clicked.connect(self.run_scan)

	def run_scan(self):
		
		self.parent().parent().console=ConsoleWidget()
		self.parent().parent().console.show()
		interface = str(self.ui.textEdit.toPlainText())
		ip_src = str(self.ui.textEdit_2.toPlainText())
		ip_mac = int(self.ui.textEdit_3.toPlainText())

		# self.parent().parent().centralWidget().setCurrentIndex(0)

		main1(interface,ip_src,ip_mac)


class Ui_ScanWidget(object):
    def setupUi(self, Form):
        Form.setObjectName("Form")
        Form.resize(400, 300)
        self.pushButton = QtGui.QPushButton(Form)
        self.pushButton.setGeometry(QtCore.QRect(160, 170, 88, 34))
        self.pushButton.setObjectName("pushButton")
        self.textEdit = QtGui.QTextEdit(Form)
        self.textEdit.setGeometry(QtCore.QRect(10, 70, 104, 31))
        self.textEdit.setObjectName("textEdit")
        self.textEdit_2 = QtGui.QTextEdit(Form)
        self.textEdit_2.setGeometry(QtCore.QRect(150, 70, 104, 31))
        self.textEdit_2.setObjectName("textEdit_2")
        self.textEdit_3 = QtGui.QTextEdit(Form)
        self.textEdit_3.setGeometry(QtCore.QRect(280, 70, 104, 31))
        self.textEdit_3.setObjectName("textEdit_3")
        self.label = QtGui.QLabel(Form)
        self.label.setGeometry(QtCore.QRect(30, 40, 59, 18))
        self.label.setObjectName("label")
        self.label_2 = QtGui.QLabel(Form)
        self.label_2.setGeometry(QtCore.QRect(170, 40, 59, 18))
        self.label_2.setObjectName("label_2")
        self.label_3 = QtGui.QLabel(Form)
        self.label_3.setGeometry(QtCore.QRect(290, 40, 81, 18))
        self.label_3.setObjectName("label_3")

        self.retranslateUi(Form)
        QtCore.QMetaObject.connectSlotsByName(Form)

    def retranslateUi(self, Form):
        Form.setWindowTitle(QtGui.QApplication.translate("Form", "Form", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton.setText(QtGui.QApplication.translate("Form", "Scan", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("Form", "Interface", None, QtGui.QApplication.UnicodeUTF8))
        self.label_2.setText(QtGui.QApplication.translate("Form", "Router IP", None, QtGui.QApplication.UnicodeUTF8))
        self.label_3.setText(QtGui.QApplication.translate("Form", "Router Mac", None, QtGui.QApplication.UnicodeUTF8))

class Ui_Welcome(object):
    def setupUi(self, Form):
        Form.setObjectName("Form")
        Form.resize(687, 300)
        self.label = QtGui.QLabel(Form)
        self.label.setGeometry(QtCore.QRect(8, 7, 451, 171))
        self.label.setText("")
        self.label.setPixmap(QtGui.QPixmap("../Downloads/logos.png"))
        self.label.setScaledContents(True)
        self.label.setObjectName("label")

        self.retranslateUi(Form)
        QtCore.QMetaObject.connectSlotsByName(Form)

    def retranslateUi(self, Form):
        Form.setWindowTitle(QtGui.QApplication.translate("Form", "Form", None, QtGui.QApplication.UnicodeUTF8))

class Ui_ARPFrame(object):
	def setupUi(self, Form):
		Form.setObjectName("Form")
		Form.resize(400, 300)
		self.plainTextEdit = QtGui.QPlainTextEdit(Form)
		self.plainTextEdit.setGeometry(QtCore.QRect(100, 40, 104, 31))
		self.plainTextEdit.setObjectName("plainTextEdit")
		self.plainTextEdit_2 = QtGui.QPlainTextEdit(Form)
		self.plainTextEdit_2.setGeometry(QtCore.QRect(100, 120, 104, 31))
		self.plainTextEdit_2.setObjectName("plainTextEdit_2")
		self.label = QtGui.QLabel(Form)
		self.label.setGeometry(QtCore.QRect(20, 50, 59, 18))
		self.label.setObjectName("label")
		self.label_2 = QtGui.QLabel(Form)
		self.label_2.setGeometry(QtCore.QRect(20, 130, 59, 18))
		self.label_2.setObjectName("label_2")
		self.pushButton = QtGui.QPushButton(Form)
		self.pushButton.setGeometry(QtCore.QRect(260, 210, 88, 34))
		self.pushButton.setObjectName("pushButton")

		self.retranslateUi(Form)
		QtCore.QMetaObject.connectSlotsByName(Form)

	def retranslateUi(self, Form):
		Form.setWindowTitle(QtGui.QApplication.translate("Form", "Form", None, QtGui.QApplication.UnicodeUTF8))
		self.label.setText(QtGui.QApplication.translate("Form", "Target 1", None, QtGui.QApplication.UnicodeUTF8))
		self.label_2.setText(QtGui.QApplication.translate("Form", "Target 2", None, QtGui.QApplication.UnicodeUTF8))
		self.pushButton.setText(QtGui.QApplication.translate("Form", "Start", None, QtGui.QApplication.UnicodeUTF8))

class Ui_Console(object):

	def setupUi(self, Console):
		Console.setObjectName("Console")
		Console.resize(400, 300)
		self.textEdit = QtGui.QTextEdit(Console)
		self.textEdit.setGeometry(QtCore.QRect(-7, -7, 411, 261))
		self.textEdit.setObjectName("textEdit")
		self.pushButton = QtGui.QPushButton(Console)
		self.pushButton.setGeometry(QtCore.QRect(150, 260, 88, 34))
		self.pushButton.setObjectName("pushButton")

		self.retranslateUi(Console)
		QtCore.QMetaObject.connectSlotsByName(Console)

	def retranslateUi(self, Console):
		Console.setWindowTitle(QtGui.QApplication.translate("Console", "Dialog", None, QtGui.QApplication.UnicodeUTF8))
		self.pushButton.setText(QtGui.QApplication.translate("Console", "Clear", None, QtGui.QApplication.UnicodeUTF8))		

class EmittingStream(QtCore.QObject):

	textWritten = QtCore.pyqtSignal(str)

	def write(self, text):
		self.textWritten.emit(str(text))



def main():

	app = QtGui.QApplication(sys.argv)
	#Creates the individual widgets
	# widget_console = console_widget()
	# widget_arp_frame = arp_frame_widget()
	# stackedWidget = QtGui.QStackedWidget()
	# #Inserts them into the QStackedWidget
	# stackedWidget.insertWidget(0, widget_console)
	# stackedWidget.insertWidget(1, widget_arp_frame)
	# stackedWidget.setCurrentIndex(1)
	#Created the MainWindow
	main_window = ControlMainWindow()
	#Sets the QStackedWidget as the layout for the mainwindow
	# main_window.setCentralWidget(stackedWidget)
	main_window.show()
	sys.exit(app.exec_())

if __name__ == "__main__":

	main()